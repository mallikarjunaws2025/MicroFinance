@model IEnumerable<TestApp.DB.Member>

@{
    Layout = "~/Views/Shared/_LayoutPage.cshtml"; 
    WebGrid webGrid = new WebGrid(source: Model, canPage: true, canSort: false);
}
 
<!DOCTYPE html>
 
<html>
<head>    
    <title>Index</title>
    <style type="text/css">
       
    
        .label {
            color: grey;
        }
        .Grid {
            border: 1px solid #ccc;
            border-collapse: collapse;
            margin-top:5%;
        }
 
        .Grid th {
            background-color: #428bca;
            font-weight: bold;
        }
 
        .Grid th, .Grid td {
            padding: 5px;
            width: 150px;
            border: 1px solid #ccc;
        }
 
        .Grid, .Grid table td {
            border: 0px solid #ccc;
        }
 
        .Grid th a, .Grid th a:visited {
            color: #333;
        }
    </style>
</head>
<body>
             <div class="container" ;border-color: "darkgrey";border-width:"2px";">
    <div class="well form-horizontal" style="margin-top: 3%;">
      <div style="width:100%;overflow:auto"> 
    @webGrid.GetHtml(
        htmlAttributes: new { @id = "WebGrid", @class = "Grid" },
        columns: webGrid.Columns(
                 webGrid.Column(header: "MbrId", format: @<text>  <span  class="display-mode">@item.MbrId </span> <label id="lblMbrId" class="edit-mode">@item.MbrId</label> </text>, style: "col1Width" ),
                 webGrid.Column(header: "Name", format: @<text>  <span  class="display-mode"> <label id="lblMbrName"  >@item.MbrName</label> </span> <input type="text" id="Name" value="@item.MbrName" class="edit-mode" /></text>, style: "col2Width"),  
                 webGrid.Column(header: "GroupCode", format: @<text>  <span  class="display-mode"> <label id="lblGroupCode"  >@item.GroupCode</label> </span> <input type="text" id="GroupCode" value="@item.GroupCode" class="edit-mode" /></text>, style: "col2Width"),  
                 webGrid.Column(header: "Withdraw Date", format: @<text> <span  class="display-mode"> <label id="lblWithdrawDt">@item.WithdrawDt</label> </span>  <input type="text" id="WithdrawDt" value="@item.WithdrawDt" class="edit-mode" /> </text>, style: "col2Width"),   
                 webGrid.Column(format: @<text>  
                                <button class="edit-user display-mode" style="background-color: #428bca;font-weight: bold" >Edit</button>  
                                <button class="save-user edit-mode" style="background-color:lightgreen" >Save</button>  
                                <button class="cancel-user edit-mode" style="background-color:orangered">Cancel</button>   
                            </text>,  style: "col3Width" , canSort: false)))
    <br/>
                    </div> 
        </div>
    </div>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script type="text/javascript" src="https://ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js"></script>
    <script type="text/javascript">

@*        function getbyID(MbrID) {           

            var Wdate = prompt("Please enter Withdraw Date", "");

            $.ajax({
                url: '@Url.Action("UpdateMemberWDt", "Loans")',
                type: "GET",
                   contentType: "application/json;charset=utf-8",
                   async: true,
                   data: { MbrID: MbrID, Wdate: Wdate },
                   catch: false,
                   success: function (result) {
                       if (result == 'True') {
                           alert("Sucessfully updated withdraw date");
                       } else {
                           alert("Error While validating Member");
                       }
                        },
                   error: function (errormessage) {
                       alert("Error While validating Member");
                   }
               });
        }*@


        $(function () {

            $('.edit-mode').hide();
            $('.edit-user, .cancel-user').on('click', function () {
                var tr = $(this).parents('tr:first');
                tr.find('.edit-mode, .display-mode').toggle();
            });

            $('.save-user').on('click', function () {
                var tr = $(this).parents('tr:first');

                var MbrId = tr.find("#lblMbrId").html();
                var WithdrawDt = tr.find("#WithdrawDt").val();

                tr.find("#lblMbrId").text(MbrId);
                tr.find("#lblWithdrawDt").text(WithdrawDt);


                tr.find('.edit-mode, .display-mode').toggle();
                var UserModel = MbrId + "," + WithdrawDt;
             
                $.ajax({
                    url: '@Url.Action("UpdateMemberWDt", "Loans")',
               data: { UserModel: UserModel },
               type: 'GET',
               contentType: 'application/json; charset=utf-8',
               success: function (data) {
                   if (data == 'Success') {
                       $.ajax({
                           url: '@Url.Action("WithdrawDateScreen", "Loans")',
                                type: 'GET',
                                contentType: 'application/json; charset=utf-8',
                                success: function (data) {

                                }
                            });
                            alert("Successfully updated Staff details");
                        }
                        else {
                            alert("Failed to update please try again");
                        }
                    }
                });

            });
        })
</script>  
</body>
</html>