@model TestApp.VModels.Member.MemberViewModel
@{
    ViewBag.Title = "CreateBranch";
    Layout = "~/Views/Shared/_LayoutPage.cshtml";
}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Create Branch</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js" type="text/javascript"></script>
    <link rel='stylesheet prefetch' href='http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css'>
    <link rel='stylesheet prefetch' href='http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css'>
    <link rel='stylesheet prefetch' href='http://cdnjs.cloudflare.com/ajax/libs/jquery.bootstrapvalidator/0.5.0/css/bootstrapValidator.min.css'>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/4.4.0/bootbox.min.js">  
    </script>
</head>
<style>
    .drpdwn {
        width: 25%;
        height: 30px;
    }
</style>
<body>

    <div class="container" style="border-color: darkgrey; border-width: 2px;">
        @using (Html.BeginForm("CreateMember", "Member", FormMethod.Post, htmlAttributes: new { @class = "well form-horizontal", @id = "myform" }))
        { 
            @Html.HiddenFor(model => model.IsSucess, new { @id = "IsSucess" })
            @Html.HiddenFor(model => model.MbrDOJ, new { @id = "MbrDOJ" })
            //@Html.ValidationSummary(false, "", new { @id = "Errors", @class = "text-danger" }) 
            <label id="lblmgs"></label>
            <fieldset>

                <!-- Form Name -->
                <legend>
                    <h2><b>Member Registration</b></h2>
                </legend>
                <br>
                <!-- Group Code-->
                <div class="form-group">
                    <label class="col-md-2 control-label">Group Name</label>
                    <div class="col-md-3 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="fa fa-group"></i></span>
                            @Html.DropDownListFor(x => Model.GrpCode, 
                                Model.GrpNameList != null ? new SelectList(Model.GrpNameList, "Value", "Text") : new SelectList(new List<object>(), "Value", "Text"), 
                                "-Group Code-", 
                                htmlAttributes: new { @class = "form-control", @id = "dGrpCode" })
                        </div>
                    </div>

                    <!-- Member Name-->
                    <label class="col-md-2 control-label">Member Name</label>
                    <div class="col-md-3 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            @Html.TextBoxFor(model => model.MbrName, new { @class = "form-control", @placeholder = "Member Name", @required = "required", @id = "MbrName" })
                        </div>
                    </div>
                </div>



                <!-- Gender -->
                <div class="form-group">
                    <label class="col-md-2 control-label">Gender</label>
                    <div class="col-md-3 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="fa fa-transgender-alt"></i></span>
                            @Html.DropDownListFor(model => model.Gen, new List<SelectListItem> { new SelectListItem { Value = "Male", Text = "Male" }, new SelectListItem { Value = "Female", Text = "Female" } }, "-Select Gender-", new { @class = "form-control", @id = "Gen" })
                        </div>
                    </div>
                    <!-- Husband Name -->
                    <label class="col-md-2 control-label">Husband Name</label>
                    <div class="col-md-3 selectContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="fa fa-male"></i></span>
                            @Html.TextBoxFor(model => model.HsbndName, new { @class = "form-control", @placeholder = "Husband Name", @required = "required", @id = "HsbndName" })
                        </div>
                    </div>
                </div>

                <!--Age-->
                <div class="form-group">
                    <label class="col-md-2 control-label">Age</label>
                    <div class="col-md-3 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            @Html.TextBoxFor(model => model.Age, new { @class = "form-control", @placeholder = "Age", @required = "required", @id = "Age" })
                        </div>
                    </div>

                    <!-- MDOJ-->
                    <label class="col-md-2 control-label">Date of Join</label>
                    <div class="col-md-3 selectContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
                            <input class="form-control" required="required" type="date" id="idDOB">
                        </div>
                    </div>
                </div>

                <!-- Status-->
                <div class="form-group">
                    <label class="col-md-2 control-label">Status</label>
                    <div class="col-md-3 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="fa fa-toggle-on"></i></span>
                            @Html.DropDownListFor(model => model.MbrStatus, new List<SelectListItem> { new SelectListItem { Value = "Active", Text = "Active" }, new SelectListItem { Value = "Cancel", Text = "Cancel" } }, "-Select Status-", new { @class = "form-control", @placeholder = "Member Status", @required = "required", @id = "MbrStatus" })
                        </div>
                    </div>

                    @*<!-- MDOJ-->
<div class="form-group">
  <label class="col-md-2 control-label" >WithDraw Date</label> 
    <div class="col-md-3 inputGroupContainer">
    <div class="input-group">
  <span class="input-group-addon"><i class="glyphicon glyphicon-list"></i></span>&nbsp
        @Html.DropDownListFor(x => Model.WD, Enumerable.Range(1,31).Select(i=> new SelectListItem {Value=i.ToString(),Text=i.ToString()}),"-Day-", htmlAttributes: new {@class="drpdwn", @id = "WD"})&nbsp&nbsp;
         @Html.DropDownListFor(x => Model.WM,Enumerable.Range(1,12).Select(i=> new SelectListItem {Value=i.ToString(),Text=i.ToString()}),"-Month-", htmlAttributes: new {@class="drpdwn", @id = "WM"})&nbsp&nbsp;
         @Html.DropDownListFor(x => Model.WY,Enumerable.Range(2015,DateTime.Now.Year-2014).Select(i=> new SelectListItem {Value=i.ToString(),Text=i.ToString()}),"-Year-", htmlAttributes: new {@class="drpdwn", @id = "WY"})
    </div>
  </div>
</div>*@

                    <!-- Staff Name-->
                    <label class="col-md-2 control-label">Staff Name</label>
                    <div class="col-md-3 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="fa fa-wheelchair"></i></span>
                            @Html.DropDownListFor(x => Model.StaffID, new SelectList(Model.StaffMbrList, "Value", "Text"), "-Staff Name-", new { @class = "form-control", @id = "StaffID" })
                        </div>
                    </div>
                </div>

                <!--Member Address-->
                <div class="form-group">
                    <label class="col-md-2 control-label">Address</label>
                    <div class="col-md-3 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-map-marker"></i></span>
                            @Html.TextBoxFor(model => model.MbrAddress, new { @class = "form-control", @placeholder = "Member Address", @required = "required", @id = "MbrAddress" })
                        </div>
                    </div>

                    <!-- Cantact Num -->
                    <label class="col-md-2 control-label">Cantact Num</label>
                    <div class="col-md-3 selectContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-earphone"></i></span>
                            @Html.TextBoxFor(model => model.CantactNum, new { @class = "form-control", @placeholder = "Cantact Num", @required = "required", @id = "CantactNum" })
                        </div>
                    </div>
                </div>


                <!--KYC Details-->
                <div class="form-group">
                    <label class="col-md-2 control-label">Adhar Card Num</label>
                    <div class="col-md-3 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-font"></i></span>
                            @Html.TextBoxFor(model => model.AdharaCardNum, new { @class = "form-control", @placeholder = "Adhara Card Num", @maxlength = "12", @required = "required", @id = "AdharaCardNum" })
                        </div>
                    </div>

                    <!-- Ration Card -->
                    <label class="col-md-2 control-label">Ration Card Num</label>
                    <div class="col-md-3 selectContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-barcode"></i></span>
                            @Html.TextBoxFor(model => model.RationCardNum, new { @class = "form-control", @placeholder = "Ration Card Num", @id = "RationCardNum" })
                        </div>
                    </div>
                </div>

                <!--Nominee-->
                <div class="form-group">
                    <label class="col-md-2 control-label">Nominee</label>
                    <div class="col-md-3 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="fa fa-male"></i></span>
                            @Html.TextBoxFor(model => model.Nominee, new { @class = "form-control", @placeholder = "Nominee ", @id = "Nominee" })
                        </div>
                    </div>

                    <!-- Cantact Num2 -->
                    <label class="col-md-2 control-label">Cantact Num 2</label>
                    <div class="col-md-3 selectContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-earphone"></i></span>
                            @Html.TextBoxFor(model => model.PhoneNo2, new { @class = "form-control", @placeholder = "Cantact Num2", @id = "PhoneNo2" })
                        </div>
                    </div>
                </div>

                <!-- Success message -->
                <label class="alert alert-success" style="display: none" role="alert" id="success_message"><i class="glyphicon glyphicon-thumbs-up"></i>Success!.</label>

                <!-- Button -->
                <div class="form-group">
                    <label class="col-md-4 control-label"></label>
                    <div class="col-md-4 inputGroupContainer">
                        <input type="submit" id="btnSave" hidden="hidden" />&nbsp
                        <input type="button" id="btnSaveTmp" class="btn btn-warning" value="Save" />&nbsp
                        
                        <input type="button" value="Cancel" id="btnCancel" class="btn btn-warning" style="float: right" />&nbsp&nbsp&nbsp&nbsp
                        <input type="button" id="btnSaveNext" style="display: none;float: right;margin-right:5%;" class="btn btn-warning" value="Disbus Loans" />&nbsp&nbsp
                    </div>
                </div>

            </fieldset>
        }
    </div>
    <!-- /.container -->
    <script src='http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
    <script src='http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js'></script>
    <script src='http://cdnjs.cloudflare.com/ajax/libs/bootstrap-validator/0.4.5/js/bootstrapvalidator.min.js'></script>
    <script src="js/index.js"></script>
</body>
</html>
<script>
    $(document).ready(function () {
         

        if ('@Model.IsSucess' == "1") {
            $("#lblmgs").html("<h3 style='color: green;'>Successfully Created Member. Member ID : " + '@Session["SavedMbrID"]' + "</h3>");
             
            $("#btnSaveTmp").attr('disabled', true);

            $("#btnSaveNext").css('display', 'block');

            //$("#btnSaveNext").trigger("click");
        }
        else if ('@Model.IsSucess' == "2") {
            $("#lblmgs").html("<h3 style='color: red;'>Failed To Created Member Please try again.</h3>"); 
            $("#btnSaveNext").css('display', 'none');
        }
        else if ('@Model.IsSucess' == "A") {
            $("#lblmgs").html("<h3 style='color: red;'>Already Member linked to this Adhard Card Number.</h3>");
            alert("Already Member linked to this Adhard Card Number.");
        }


    });

$("#btnCancel").click(function () {
    $("form")[0].reset(InputData); //.attr("action", "/home/cancelform");
});

$("#idDOB").change(function () {
    $("#lblmgs").html('');
    if ($('#idDOB').val().length == 0) {
        //$("#lblmgs").html("<h3 style='color: red;'>Please select Date of Join.</h3>");
        return;
    }
    else {
        var today = new Date();
        var frmDt = new Date($('#idDOB').val());
        if (frmDt.getDate() > today.getDate() && frmDt.getMonth() >= today.getMonth() && frmDt.getFullYear() == today.getFullYear()) {
            $("#lblmgs").html("<h3 style='color: red;'>Feture date is not allowed.</h3>");
            return;
        }
        else {
            $('#MbrDOJ').val(frmDt.toLocaleDateString());
            $("#lblmgs").html('');
        }
    }
});

$("#btnSaveNext").click(function () {
    debugger;
    
    var resultOk = bootbox.confirm('Do you want to Disbus Loan immediatly?', function (result) { });
    if (resultOk) {
       
        $('#myform')[0].reset();
        window.location = "/Loans/LoansDisbus?iMbrID=" + '@Session["SavedMbrID"]';
    }
    $('#myform')[0].reset();
});


$("#btnSaveTmp").click(function () {
    debugger;
    var msg = "";

    var drpGpID = $("#dGrpCode option:selected").val();
    if (drpGpID == "" || drpGpID == '-Group Code-') {
        msg = msg + "<br/> Please select Group Code";
    }

    if ($("#MbrName").val().length == 0) {
        msg = msg + "<br/> Please enter menber name";
    }


    drpGpID = $("#Gen option:selected").val();
    if (drpGpID == "" || drpGpID == '-Select Gender-') {
        msg = msg + "<br/> Please select gender";
    }

    if ($("#HsbndName").val().length == 0) {
        msg = msg + "<br/> Please enter Husbend Name";
    }

    if ($("#Age").val().length == 0 || $("#Age").val() == "0") {
        msg = msg + "<br/> Please enter Age";
    }

    if ($("#idDOB").val().length == 0) {
        msg = msg + "<br/> Please enter Date of Join";
    }

    drpGpID = $("#MbrStatus option:selected").val();
    if (drpGpID == "" || drpGpID == '-Select Status-') {
        msg = msg + "<br/> Please select status";
    }

    drpGpID = $("#StaffID option:selected").val();
    if (drpGpID == "" || drpGpID == '-Staff Name-') {
        msg = msg + "<br/> Please select Staff Name";
    }

    if ($("#MbrAddress").val().length == 0) {
        msg = msg + "<br/> Please enter Address";
    }

    if ($("#CantactNum").val().length == 0) {
        msg = msg + "<br/> Please enter Cantact Num";
    }

    if ($("#AdharaCardNum").val().length == 0) {
        msg = msg + "<br/> Please enter Adhara Card Num";
    }

    if ($("#Nominee").val().length == 0) {
        msg = msg + "<br/> Please enter Nominee";
    }



    if (msg != "") {
        bootbox.alert(msg);
    }
    else {
        $("#btnSave").trigger("click");
    }
});



</script>
